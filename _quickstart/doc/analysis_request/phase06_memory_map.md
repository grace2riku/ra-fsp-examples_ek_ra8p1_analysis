# Phase 6: メモリマップ解析

## カテゴリ
基盤編

## 概要
リンカスクリプトを解析し、メモリマップとセクション配置を明確にする。

## 解析要求事項

リンカスクリプト（.ld ファイル）を解析し、メモリマップを説明してください。

### 1. メモリ領域の定義

リンカスクリプトの `MEMORY` セクションを解析してください：

| 領域名 | 開始アドレス | サイズ | 属性 | 用途 |
|--------|-------------|--------|------|------|
| FLASH | 0x0000_0000 | 1MB | rx | コード |
| RAM | 0x2000_0000 | 512KB | rwx | データ |
| ... | ... | ... | ... | ... |

#### 内蔵メモリ
- Code MRAM（プログラムコード領域）
- SRAM（データ領域）
- TCM（Tightly Coupled Memory）

#### 外部メモリ（使用している場合）
- 外部SDRAM
- 外部OSPI Flash

### 2. セクション配置

`SECTIONS` の内容を解析してください：

| セクション名 | 配置先 | 説明 |
|-------------|--------|------|
| .text | FLASH | プログラムコード |
| .rodata | FLASH | 読み取り専用データ |
| .data | RAM (LMA: FLASH) | 初期化済みデータ |
| .bss | RAM | 未初期化データ |
| .stack | RAM | スタック領域 |
| .heap | RAM | ヒープ領域 |

#### セクションの詳細

各セクションについて以下を調査：
- VMA (Virtual Memory Address) - 実行時アドレス
- LMA (Load Memory Address) - ロード時アドレス
- サイズ
- アライメント

### 3. 特殊なセクション

以下のカスタムセクションがあれば調査してください：

| 用途 | セクション名 | 配置場所 | サイズ |
|------|-------------|----------|--------|
| フレームバッファ | .fb_section | SDRAM | ? |
| 画像データ | .image_data | FLASH | ? |
| フォントデータ | .font_data | FLASH | ? |
| DMAバッファ | .dma_buffer | RAM | ? |
| キャッシュ不可領域 | .noncacheable | RAM | ? |

### 4. デュアルコア構成の場合

CM85用とCM33用のメモリ分割：

```
┌─────────────────────────────────────┐
│           Memory Map                │
├─────────────────────────────────────┤
│ 0xFFFF_FFFF                         │
│                                     │
│  [Peripheral Region]                │
│                                     │
├─────────────────────────────────────┤
│  [CM33 SRAM]                        │
├─────────────────────────────────────┤
│  [CM85 SRAM]                        │
├─────────────────────────────────────┤
│  [Shared SRAM]                      │
├─────────────────────────────────────┤
│ 0x2000_0000                         │
├─────────────────────────────────────┤
│  [CM33 Code MRAM]                   │
├─────────────────────────────────────┤
│  [CM85 Code MRAM]                   │
├─────────────────────────────────────┤
│ 0x0000_0000                         │
└─────────────────────────────────────┘
```

### 5. メモリ使用量の確認方法

- .map ファイルの読み方
- サイズ情報の取得方法
- メモリ使用率の計算

## 期待する成果物

### 1. メモリマップ図

```
アドレス          サイズ      領域名          用途
─────────────────────────────────────────────────
0x0000_0000 ┬─────────────────────────────────────
            │    1 MB       MRAM            Code
0x000F_FFFF ┴─────────────────────────────────────
            
0x2000_0000 ┬─────────────────────────────────────
            │    256 KB     TCM_RAM         高速データ
0x2003_FFFF ┼─────────────────────────────────────
            │    512 KB     SRAM            一般データ
0x200B_FFFF ┴─────────────────────────────────────

0x6800_0000 ┬─────────────────────────────────────
            │    64 MB      SDRAM           フレームバッファ等
0x6BFF_FFFF ┴─────────────────────────────────────
```

### 2. セクション配置表

| セクション | VMA | LMA | サイズ | 内容 |
|-----------|-----|-----|--------|------|
| .vectors | 0x00000000 | 0x00000000 | 0x400 | 割込みベクタ |
| .text | 0x00000400 | 0x00000400 | 変動 | コード |
| ... | ... | ... | ... | ... |

### 3. 各領域の用途とサイズの説明

用途別のメモリ配置と、設計意図の説明を含めてください。
